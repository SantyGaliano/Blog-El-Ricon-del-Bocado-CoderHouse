{% extends "base.html" %}
{% load static %}

{% block title %}Inicio · El Rincón del Bocado{% endblock %}

{% block fullwidth_content %}
<section class="hero-wrap" aria-label="Hero principal">
  <!-- VIDEO de fondo -->
  <video class="hero-video" autoplay muted loop playsinline>
    <source src="{% static 'videos/9020877-uhd_3840_2160_25fps.mp4' %}" type="video/mp4">
  </video>
  <div class="hero-grad-1"></div>
  <div class="hero-grad-2"></div>

  <!-- CONTENIDO -->
  <div class="hero-inner">
    <span class="hero-badge">
      🍽️ Bienvenido • Comunidad de Recetas
    </span>

    <h1 class="hero-title">
      Donde los Sabores <span class="g">cobran vida</span>
    </h1>

    <p class="hero-desc">
      Explora recetas extraordinarias de chefs y entusiastas de todo el mundo.
      Aprende técnicas, comparte tus platos y descubre tu próxima favorita.
    </p>

    <div class="hero-actions">
      <a href="{% url 'recipe-list' %}" class="btn-grad">Explorar Recetas →</a>

      <!-- CTA NUEVO: ancla nativa + JS mejorado -->
      <a id="ctaDiscover" class="cta-neo" href="#discover" role="button" data-tilt="1" aria-label="Descubrir más">
        <span class="inner">
          <span class="label">Descubrir más</span>
          <svg class="arrow" viewBox="0 0 24 24" fill="none" aria-hidden="true">
            <path d="M5 12h12" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
            <path d="M13 6l6 6-6 6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
        </span>
      </a>
    </div>
  </div>
</section>

<!-- Sección de destino para el scroll suave -->
<section id="discover" class="py-5">
  <div class="container">
    <h2 class="mb-3 text-white">Descubre qué puedes hacer aquí</h2>
    <p class="mb-4" style="color:rgba(255,255,255,.8)">Comparte tus recetas, guarda favoritas y aprende nuevas técnicas.</p>

    <div class="features">
      <div class="feature">
        <div style="font-size:1.4rem">📸</div>
        <h4>Fotos irresistibles</h4>
        <p>Sube imágenes de tus platos y hacelos brillar con nuestra galería.</p>
      </div>
      <div class="feature">
        <div style="font-size:1.4rem">🧑‍🍳</div>
        <h4>Tu perfil culinario</h4>
        <p>Crea tu bio, subí tu avatar y mostrá tu estilo en la cocina.</p>
      </div>
      <div class="feature">
        <div style="font-size:1.4rem">🔎</div>
        <h4>Búsquedas potentes</h4>
        <p>Filtrá por nombre, dificultad o ingredientes para encontrar la receta perfecta.</p>
      </div>
    </div>
  </div>
</section>
{% endblock %}

{% block content %}{% endblock %}

{% block extra_js %}
<script>
  (function(){
    // Función para obtener offset dinámico (topbar + navbar)
    const getFixedOffset = () => {
      const topbar = document.getElementById('topbar');
      const nav = document.querySelector('.navbar-custom');
      const tb = topbar && getComputedStyle(topbar).display !== 'none' ? topbar.offsetHeight : 0;
      const nh = nav ? nav.offsetHeight : 0;
      return tb + nh + 8;
    };

    // Smooth scroll del CTA con ripple y corrección por elementos fijos
    const cta = document.getElementById('ctaDiscover');
    if (cta){
      cta.addEventListener('click', (e) => {
        // ripple
        const rect = cta.getBoundingClientRect();
        const r = document.createElement('span');
        r.className = 'ripple';
        r.style.left = (e.clientX - rect.left) + 'px';
        r.style.top  = (e.clientY - rect.top)  + 'px';
        cta.appendChild(r);
        setTimeout(()=>r.remove(), 650);

        // scroll corregido
        const href = cta.getAttribute('href') || '#discover';
        if (href.startsWith('#')) {
          const target = document.querySelector(href);
          if (target){
            e.preventDefault();
            const offset = getFixedOffset();
            const y = target.getBoundingClientRect().top + window.scrollY - offset;
            window.scrollTo({ top: y, behavior: 'smooth' });
          }
        }
      });

      // Efecto magnético / tilt sutil
      if (cta.dataset.tilt === '1' && !window.matchMedia('(prefers-reduced-motion: reduce)').matches){
        const strength = 10; // px
        const onMove = (ev) => {
          const r = cta.getBoundingClientRect();
          const cx = r.left + r.width/2;
          const cy = r.top  + r.height/2;
          const dx = (ev.clientX - cx) / (r.width/2);
          const dy = (ev.clientY - cy) / (r.height/2);
          cta.style.transform = `translate(${dx*strength}px, ${dy*strength}px)`;
        };
        const reset = () => { cta.style.transform = 'translate(0,0)'; };
        cta.addEventListener('pointermove', onMove);
        cta.addEventListener('pointerleave', reset);
        cta.addEventListener('blur', reset);
      }
    }
  })();
</script>
{% endblock %}
